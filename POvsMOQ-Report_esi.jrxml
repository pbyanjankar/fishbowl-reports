<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="POvsMOQ-Report-ESA" pageWidth="612" pageHeight="792" columnWidth="572" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="883e6ed2-3549-46a7-b1ed-bee6299caaaa">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="dateRange1" class="java.util.Date" isForPrompting="false">
		<parameterDescription><![CDATA[This Month]]></parameterDescription>
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="dateRange2" class="java.util.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="partNum" class="java.lang.String" isForPrompting="false"/>
	<queryString>
		<![CDATA[select
company.name as company,
part.num as partnum,
minorderqty.info as minorderqty,
pos.qty as qtyonpo,
sos.qty as qtyonso,
pos.pos as polist,
sos.sos as solist,
sos.uom as souom,
sos.qty * uomconversion.multiply as totalqtyonso


from part
inner join company on company.id = 1
inner join (select sum(soitem.qtytofulfill - soitem.qtyfulfilled) as qty,
                   group_concat(distinct so.num separator ', ') as sos,
                   product.partid,
                   uom.id as uomid,
                   uom.code as uom

              from soitem
               inner join so on soitem.soid = so.id and so.statusid IN (20,25)
               inner join product on soitem.productid = product.id
               left join uom on soitem.uomid = uom.id
                where soitem.statusid < 50
		group by partid, uomid, uom) sos on sos.partid = part.id
 inner join (select sum(receiptitem.qty) as qty,
                   group_concat(distinct po.num separator ', ') as pos,
                   poitem.partid
              from receiptitem
               inner join poitem on poitem.id = receiptitem.poitemid and receiptitem.statusid = 10
               inner join po on poitem.poid = po.id and po.statusid between 20 and 60
                where po.dateissued between $P{dateRange1} and date_sub($P{dateRange2}, interval 1 second)
               group by partid) pos on pos.partid = part.id
 inner join customfield cf on cf.name = 'Minimum Order Qty' and cf.tableid = -2003201472
 inner join customdecimal minorderqty on minorderqty.customfieldid = cf.id and minorderqty.recordid = part.id
 left outer join customfield cf2 on cf2.name = "Standard Wheel" AND cf2.tableid = -2003201472
 left outer join custominteger standardwheel on standardwheel.customfieldid = cf2.id and standardwheel.recordid = part.id

LEFT OUTER JOIN uomconversion ON (part.uomid = uomconversion.touomid AND sos.uomid = uomconversion.fromuomid)


where part.num LIKE ($P{partNum})
AND ((sos.qty * uomconversion.multiply) < 16 OR (pos.qty > sos.qty * uomconversion.multiply))
AND coalesce(standardwheel.info,0) = 1

order by part.num]]>
	</queryString>
	<field name="COMPANY" class="java.lang.String"/>
	<field name="PARTNUM" class="java.lang.String"/>
	<field name="MINORDERQTY" class="java.lang.Integer"/>
	<field name="QTYONPO" class="java.lang.Double"/>
	<field name="QTYONSO" class="java.lang.Double"/>
	<field name="POLIST" class="java.lang.String"/>
	<field name="SOLIST" class="java.lang.String"/>
	<field name="SOUOM" class="java.lang.String"/>
	<field name="totalqtyonso" class="java.lang.Double"/>
	<variable name="DateFormat" class="java.lang.String" resetType="None">
		<variableExpression><![CDATA[(System.getProperty("REPORT_DATE_FORMAT"))]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="69" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="572" height="20" uuid="089c5b01-852f-48d1-a338-758d63cfab92"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{COMPANY}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="20" width="572" height="20" uuid="0bffcf1d-8c90-47b4-af07-d20fdd0c0be1"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[PO vs MOQ Report]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" evaluationTime="Report" pattern="" isBlankWhenNull="true">
				<reportElement key="textField-10" mode="Transparent" x="0" y="40" width="572" height="16" forecolor="#000000" backcolor="#FFFFFF" uuid="264378bd-bc0b-4c1a-816b-7f445735d00f"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#FFFFFF"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom" rotation="None">
					<font fontName="Arial" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{dateRange1}.getYear() <= -900 && $P{dateRange2}.getYear() >= 1100
  ? "Date Range: All"
  : "Date Range: " + (new SimpleDateFormat($V{DateFormat})).format($P{dateRange1}) + " - " +
(new SimpleDateFormat($V{DateFormat})).format($P{dateRange2}.getTime()-86400000)]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<columnHeader>
		<band height="25" splitType="Stretch">
			<staticText>
				<reportElement mode="Opaque" x="0" y="0" width="100" height="25" backcolor="#99FFFF" uuid="335dc653-8cfe-46d2-9bae-6130a025c467"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Part #]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="100" y="0" width="45" height="25" backcolor="#99FFFF" uuid="d7729142-d171-4a16-8df9-2a1fbc841335"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Min. Order Qty]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="190" y="0" width="45" height="25" backcolor="#99FFFF" uuid="ef425514-19da-436d-8603-f7e388d0b0f5"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Qty on SO]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="330" y="0" width="121" height="25" backcolor="#99FFFF" uuid="2c32819e-7462-4aa4-8a9a-d22dab3cfd5f"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[List of PO #s]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="451" y="0" width="121" height="25" backcolor="#99FFFF" uuid="c60f9c98-007d-4c92-8124-46162697f62a"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[List of SO #s]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="145" y="0" width="45" height="25" backcolor="#99FFFF" uuid="6e3f727d-533b-496c-80ee-0e95581f5337"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Qty on PO]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="235" y="0" width="35" height="25" backcolor="#99FFFF" uuid="eaf5b0ea-ce62-40d8-b401-673bad0ab4ba"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[SO UOM]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="270" y="0" width="60" height="25" backcolor="#99FFFF" uuid="329cd728-20dd-454c-a7f8-c4a5cd5ca2f3"/>
				<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Total Qty on SO]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="16" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true" hyperlinkType="Reference">
				<reportElement stretchType="RelativeToTallestObject" x="0" y="0" width="100" height="16" forecolor="#000099" uuid="8301d527-7317-4ee0-be61-997d27402518"/>
				<box topPadding="2" leftPadding="3" bottomPadding="2" rightPadding="3">
					<pen lineWidth="0.75" lineColor="#000000"/>
					<topPen lineWidth="0.75" lineColor="#000000"/>
					<leftPen lineWidth="0.75" lineColor="#000000"/>
					<bottomPen lineWidth="0.75" lineColor="#000000"/>
					<rightPen lineWidth="0.75" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PARTNUM}]]></textFieldExpression>
				<anchorNameExpression><![CDATA["PartNum"]]></anchorNameExpression>
				<hyperlinkReferenceExpression><![CDATA[$F{PARTNUM}]]></hyperlinkReferenceExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" x="330" y="0" width="121" height="16" uuid="38e4c681-b72c-4acc-8bc0-d6c756294ff5"/>
				<box topPadding="2" leftPadding="3" bottomPadding="2" rightPadding="3">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{POLIST}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" x="451" y="0" width="121" height="16" uuid="af0b31dc-1ebc-434f-83d1-0882a1a166f1"/>
				<box topPadding="2" leftPadding="3" bottomPadding="2" rightPadding="3">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SOLIST}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.##" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" x="100" y="0" width="45" height="16" uuid="e3758b39-0f14-4be7-ba58-a202725d7cc0"/>
				<box topPadding="2" leftPadding="3" bottomPadding="2" rightPadding="3">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{MINORDERQTY}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.##" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" x="145" y="0" width="45" height="16" uuid="90a00af6-43eb-436f-a407-83aad1fb0ea8"/>
				<box topPadding="2" leftPadding="3" bottomPadding="2" rightPadding="3">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{QTYONPO}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.##" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" x="190" y="0" width="45" height="16" uuid="b8d87691-895d-4217-8a85-d75469268795"/>
				<box topPadding="2" leftPadding="3" bottomPadding="2" rightPadding="3">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{QTYONSO}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" x="235" y="0" width="35" height="16" uuid="140c6fc7-f5ad-4ded-a023-2d325b26e83b"/>
				<box topPadding="2" leftPadding="3" bottomPadding="2" rightPadding="3">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SOUOM}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.##" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" x="270" y="0" width="60" height="16" uuid="cf85eb66-b582-4d26-9a3d-cc8b5820fbc0"/>
				<box topPadding="2" leftPadding="3" bottomPadding="2" rightPadding="3">
					<pen lineWidth="0.75"/>
					<topPen lineWidth="0.75"/>
					<leftPen lineWidth="0.75"/>
					<bottomPen lineWidth="0.75"/>
					<rightPen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{totalqtyonso}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="19" splitType="Stretch">
			<textField pattern="" isBlankWhenNull="true">
				<reportElement key="textField-37" mode="Transparent" x="270" y="5" width="181" height="14" forecolor="#000000" backcolor="#FFFFFF" uuid="10931cbd-0a4d-4c80-add3-79d75ab92079"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#FFFFFF"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None">
					<font fontName="Arial" size="9"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["Page " + $V{PAGE_NUMBER} + " of "]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report" pattern="" isBlankWhenNull="true">
				<reportElement key="textField-38" mode="Transparent" x="451" y="5" width="121" height="14" forecolor="#000000" backcolor="#FFFFFF" uuid="4de08c55-e1f6-4f18-8675-7d2b021a8e0b"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#FFFFFF"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None">
					<font fontName="Arial" size="9"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>

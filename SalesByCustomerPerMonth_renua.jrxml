<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="SalesByCustomerPerMonthRENUA" pageWidth="2160" pageHeight="612" orientation="Landscape" whenNoDataType="AllSectionsNoDetail" columnWidth="2100" leftMargin="30" rightMargin="30" topMargin="20" bottomMargin="20" uuid="9731d4f9-2aba-4200-87c1-016c52941e74">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.0980750000000004"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<style name="9" fontName="Open Sans" fontSize="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="10" isDefault="true" fontName="Open Sans" fontSize="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="12" fontName="Open Sans" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="14" fontName="Open Sans" fontSize="14" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="10b" fontName="Open Sans" fontSize="10" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="12b" fontName="Open Sans" fontSize="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="14b" fontName="Open Sans" fontSize="14" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="16b" fontName="Open Sans" fontSize="16" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="18b" fontName="Open Sans" fontSize="18" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="24b" fontName="Open Sans" fontSize="24" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="10i" fontName="Open Sans" fontSize="10" isBold="false" isItalic="true" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="12i" fontName="Open Sans" fontSize="12" isBold="false" isItalic="true" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="10bu" fontName="Open Sans" fontSize="10" isBold="true" isItalic="false" isUnderline="true" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="header1" fontName="Open Sans" fontSize="24" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="header2" fontName="Open Sans" fontSize="18" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="header3" fontName="Open Sans" fontSize="16" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="addressHeader" fontName="Open Sans" fontSize="14" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="date" fontName="Open Sans" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="type" fontName="Open Sans" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="address" fontName="Open Sans" fontSize="10" isBold="false" isItalic="true" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="column_head" fontName="Open Sans" fontSize="10" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="body" isDefault="true" fontName="Open Sans" fontSize="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="note" isDefault="true" fontName="Open Sans" fontSize="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
	<style name="Crosstab Data Text" hAlign="Center"/>
	<subDataset name="SOInfo" uuid="29eac9f8-4a7f-448b-8838-de79603785e9">
		<parameter name="path" class="java.lang.String" isForPrompting="false">
			<defaultValueExpression><![CDATA["C:/Program Files/Fishbowl/Server/reports/WorkOrder/"]]></defaultValueExpression>
		</parameter>
		<parameter name="module" class="java.lang.Object" isForPrompting="false">
			<defaultValueExpression><![CDATA[null]]></defaultValueExpression>
		</parameter>
		<parameter name="dateRange1" class="java.util.Date" isForPrompting="false">
			<parameterDescription><![CDATA[This Month]]></parameterDescription>
			<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
		</parameter>
		<parameter name="dateRange2" class="java.util.Date" isForPrompting="false">
			<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
		</parameter>
		<parameter name="ckIncludeCreditReturnItems" class="java.lang.String" isForPrompting="false">
			<parameterDescription><![CDATA[20,0]]></parameterDescription>
			<defaultValueExpression><![CDATA["20"]]></defaultValueExpression>
		</parameter>
		<queryString>
			<![CDATA[SELECT
customer.name AS CUSTOMER,
CAST(DATE_FORMAT(postso.postdate ,'%Y-%m-01') AS DATE) POSTEDDATE,
currency.symbol,
result.TOTALPRICE,
SUM(postSoItem.totalPrice) AS POSTTOTALPRICE
FROM soitem
    INNER JOIN so ON so.id = soitem.soid
    INNER JOIN customer ON customer.id = so.customerId
    INNER JOIN postsoitem ON soitem.id = postsoitem.soitemid
    INNER JOIN postso on postsoitem.postsoid = postso.id
    LEFT JOIN company ON company.id = 1
    LEFT JOIN currency ON currency.homeCurrency = 1

LEFT OUTER JOIN(
   SELECT
     customer.id AS customerId,
     SUM(postSoItem.totalPrice) AS TOTALPRICE
   FROM soitem
    INNER JOIN so ON so.id = soitem.soid
    INNER JOIN customer ON customer.id = so.customerId
    INNER JOIN postsoitem ON soitem.id = postsoitem.soitemid
    INNER JOIN postso on postsoitem.postsoid = postso.id
    LEFT JOIN company ON company.id = 1
    LEFT JOIN currency ON currency.homeCurrency = 1

   WHERE postso.postdate BETWEEN $P{dateRange1} AND DATE_SUB($P{dateRange2}, INTERVAL 1 SECOND)
      AND soitem.typeid IN (10,11,12,$P!{ckIncludeCreditReturnItems},21,30,31,40,50,60,70,80)
   GROUP BY customer.id ) AS result ON result.customerId = customer.id

WHERE postso.postdate BETWEEN $P{dateRange1} AND DATE_SUB($P{dateRange2}, INTERVAL 1 SECOND)
    AND soitem.typeid IN (10,11,12,$P!{ckIncludeCreditReturnItems},21,30,31,40,50,60,70,80)
GROUP BY 1,2,3,4


ORDER BY 4 desc, 1 asc;]]>
		</queryString>
		<field name="POSTTOTALPRICE" class="java.lang.Double"/>
		<field name="SYMBOL" class="java.lang.Integer">
			<fieldDescription><![CDATA[]]></fieldDescription>
		</field>
		<field name="POSTEDDATE" class="java.util.Date"/>
		<field name="CUSTOMER" class="java.lang.String"/>
	</subDataset>
	<parameter name="path" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["../SalesOrder/"]]></defaultValueExpression>
	</parameter>
	<parameter name="module" class="java.lang.Object" isForPrompting="false">
		<defaultValueExpression><![CDATA[null]]></defaultValueExpression>
	</parameter>
	<parameter name="dateRangeNone" class="java.lang.String" isForPrompting="false"/>
	<parameter name="dateRange1" class="java.util.Date" isForPrompting="false">
		<parameterDescription><![CDATA[This Month]]></parameterDescription>
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="dateRange2" class="java.util.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="ckIncludeCreditReturnItems" class="java.lang.String" isForPrompting="false">
		<parameterDescription><![CDATA[20,0]]></parameterDescription>
		<defaultValueExpression><![CDATA["20"]]></defaultValueExpression>
	</parameter>
	<parameter name="ReportTitle" class="java.lang.String" isForPrompting="false"/>
	<queryString>
		<![CDATA[SELECT



    COMPANY.NAME AS COMPANY


FROM company WHERE company.id = 1]]>
	</queryString>
	<field name="COMPANY" class="java.lang.String"/>
	<variable name="DateFormat" class="java.lang.String" resetType="None">
		<variableExpression><![CDATA[(System.getProperty("REPORT_DATE_FORMAT"))]]></variableExpression>
	</variable>
	<group name="CrossTab">
		<groupHeader>
			<band height="70">
				<crosstab isRepeatColumnHeaders="false">
					<reportElement x="0" y="0" width="2100" height="70" uuid="50869199-171e-4768-be2d-dc10937b0fdb"/>
					<crosstabDataset isDataPreSorted="true">
						<dataset>
							<datasetRun subDataset="SOInfo" uuid="6c51bef0-e274-44c5-924b-1b6883fef676">
								<datasetParameter name="dateRange1">
									<datasetParameterExpression><![CDATA[$P{dateRange1}]]></datasetParameterExpression>
								</datasetParameter>
								<datasetParameter name="dateRange2">
									<datasetParameterExpression><![CDATA[$P{dateRange2}]]></datasetParameterExpression>
								</datasetParameter>
								<datasetParameter name="ckIncludeCreditReturnItems">
									<datasetParameterExpression><![CDATA[$P{ckIncludeCreditReturnItems}]]></datasetParameterExpression>
								</datasetParameter>
								<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
							</datasetRun>
						</dataset>
					</crosstabDataset>
					<crosstabHeaderCell>
						<cellContents backcolor="#F0F8FF" mode="Opaque">
							<box>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<staticText>
								<reportElement x="0" y="0" width="347" height="30" uuid="a6e8ecca-bddc-4c6e-b6ab-1f54fa3bef68"/>
								<box leftPadding="3" rightPadding="3"/>
								<textElement verticalAlignment="Middle">
									<font size="10" isBold="true"/>
								</textElement>
								<text><![CDATA[Customer]]></text>
							</staticText>
						</cellContents>
					</crosstabHeaderCell>
					<rowGroup name="CUSTOMER" width="347">
						<bucket class="java.lang.String">
							<bucketExpression><![CDATA[$F{CUSTOMER}]]></bucketExpression>
						</bucket>
						<crosstabRowHeader>
							<cellContents backcolor="#F0F8FF" mode="Opaque">
								<box>
									<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
								</box>
								<textField>
									<reportElement style="Crosstab Data Text" x="0" y="0" width="347" height="25" uuid="27eb6ffa-df00-4fc8-81a3-062db3d93330"/>
									<box leftPadding="3" rightPadding="3"/>
									<textElement textAlignment="Left" verticalAlignment="Middle"/>
									<textFieldExpression><![CDATA[$V{CUSTOMER}]]></textFieldExpression>
								</textField>
							</cellContents>
						</crosstabRowHeader>
						<crosstabTotalRowHeader>
							<cellContents/>
						</crosstabTotalRowHeader>
					</rowGroup>
					<columnGroup name="POSTEDDATE" height="30" totalPosition="End">
						<bucket class="java.lang.String">
							<bucketExpression><![CDATA[(new SimpleDateFormat("yyyy/MM")).format($F{POSTEDDATE})]]></bucketExpression>
						</bucket>
						<crosstabColumnHeader>
							<cellContents backcolor="#F0F8FF" mode="Opaque">
								<box>
									<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
								</box>
								<textField pattern="">
									<reportElement style="Crosstab Data Text" x="0" y="0" width="100" height="30" uuid="838ad226-7c22-4121-91d7-9a445c15c5f0"/>
									<textElement verticalAlignment="Middle">
										<font isBold="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{POSTEDDATE}]]></textFieldExpression>
								</textField>
							</cellContents>
						</crosstabColumnHeader>
						<crosstabTotalColumnHeader>
							<cellContents backcolor="#BFE1FF" mode="Opaque">
								<box>
									<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
								</box>
								<staticText>
									<reportElement x="0" y="0" width="110" height="30" uuid="4858435a-4401-4074-92f3-34e344f3bc40"/>
									<textElement textAlignment="Center" verticalAlignment="Middle">
										<font size="10" isBold="true"/>
									</textElement>
									<text><![CDATA[Total]]></text>
								</staticText>
							</cellContents>
						</crosstabTotalColumnHeader>
					</columnGroup>
					<measure name="POSTTOTALPRICEMeasure" class="java.lang.Double" calculation="Sum">
						<measureExpression><![CDATA[$F{POSTTOTALPRICE}]]></measureExpression>
					</measure>
					<crosstabCell width="100" height="25">
						<cellContents>
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<textField>
								<reportElement style="Crosstab Data Text" x="0" y="0" width="100" height="25" uuid="379f38ef-3316-404a-aa7c-b9ad42f1a58f"/>
								<box leftPadding="3" rightPadding="3"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$V{POSTTOTALPRICEMeasure}]]></textFieldExpression>
								<patternExpression><![CDATA[System.getProperty("REPORT_DECIMAL_PRICE")]]></patternExpression>
							</textField>
						</cellContents>
					</crosstabCell>
					<crosstabCell height="25" rowTotalGroup="CUSTOMER">
						<cellContents backcolor="#005FB3" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<textField>
								<reportElement style="Crosstab Data Text" x="0" y="0" width="50" height="25" forecolor="#FFFFFF" uuid="72897b80-1d83-4dd4-80a8-215b4f4ec2d6"/>
								<textFieldExpression><![CDATA[$V{POSTTOTALPRICEMeasure}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabCell>
					<crosstabCell width="111" height="25" columnTotalGroup="POSTEDDATE">
						<cellContents backcolor="#BFE1FF" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<textField>
								<reportElement style="Crosstab Data Text" x="0" y="0" width="110" height="25" uuid="d76dbf6e-e53b-4c05-82ee-36c9981d71dd"/>
								<box leftPadding="3" rightPadding="3"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$V{POSTTOTALPRICEMeasure}]]></textFieldExpression>
								<patternExpression><![CDATA[System.getProperty("REPORT_DECIMAL_PRICE")]]></patternExpression>
							</textField>
						</cellContents>
					</crosstabCell>
					<crosstabCell rowTotalGroup="CUSTOMER" columnTotalGroup="POSTEDDATE">
						<cellContents backcolor="#005FB3" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<textField>
								<reportElement style="Crosstab Data Text" x="0" y="0" width="50" height="25" forecolor="#FFFFFF" uuid="5dc9d06a-15bf-48fb-8f88-70b78499b030"/>
								<textFieldExpression><![CDATA[$V{POSTTOTALPRICEMeasure}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabCell>
				</crosstab>
			</band>
		</groupHeader>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="54">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement key="" x="0" y="0" width="2100" height="18" uuid="b7660593-24c6-41c9-be4e-4cfa2a54e7b7"/>
				<box leftPadding="3" rightPadding="3"/>
				<textElement>
					<font fontName="Open Sans" size="13" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{COMPANY}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement key="" mode="Transparent" x="0" y="18" width="2100" height="22" forecolor="#000000" backcolor="#FFFFFF" uuid="e80b44fd-3fa4-4ac8-a24e-60abb9bc410f"/>
				<box leftPadding="3"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Open Sans" size="16" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{ReportTitle}.equals("%") ? "Sales Report" : $P{ReportTitle}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true">
				<reportElement key="" mode="Transparent" x="0" y="40" width="2100" height="14" forecolor="#000000" backcolor="#FFFFFF" uuid="2b09cc6b-ec8a-4a73-99c3-4ce8a095c51e">
					<printWhenExpression><![CDATA[true]]></printWhenExpression>
				</reportElement>
				<box leftPadding="3" rightPadding="3">
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#FFFFFF"/>
				</box>
				<textElement verticalAlignment="Bottom" rotation="None">
					<font fontName="Open Sans" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{dateRange1}.getYear() <= -900 && $P{dateRange2}.getYear() >= 1100
  ? "Date Range: All"
  : "Date Range: " + (new SimpleDateFormat($V{DateFormat})).format($P{dateRange1}) + " - " +
(new SimpleDateFormat($V{DateFormat})).format($P{dateRange2}.getTime()-129600000)]]></textFieldExpression>
			</textField>
		</band>
	</title>
</jasperReport>
